{"paragraphs":[{"text":"%md\n# LAB07: Answering Business Question","user":"yava","dateUpdated":"2019-12-20T07:28:30-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576843402005_1624608035","id":"20191220-070322_2014257805","dateCreated":"2019-12-20T07:03:22-0500","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:100022","dateFinished":"2019-12-20T07:28:30-0500","dateStarted":"2019-12-20T07:28:30-0500","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>LAB07: Answering Business Question</h1>\n</div>"}]}},{"title":"Export HIVE table to file","text":"export table <user>.stg_youtube to '/user/<user>/dataset/stg_youtube'","user":"user5","dateUpdated":"2019-12-20T07:04:27-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693878291_2099811426","id":"20191218-133118_1790335463","dateCreated":"2019-12-18T13:31:18-0500","dateStarted":"2019-12-19T03:35:32-0500","dateFinished":"2019-12-19T03:35:32-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100023"},{"text":"%sh\nhdfs dfs -ls dataset","user":"user5","dateUpdated":"2019-12-19T03:35:35-0500","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693931646_-609585366","id":"20191218-133211_105494798","dateCreated":"2019-12-18T13:32:11-0500","dateStarted":"2019-12-19T03:35:35-0500","dateFinished":"2019-12-19T03:35:52-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100024"},{"text":"%sh\nhdfs dfs -ls dataset/stg_youtube/data","user":"yava","dateUpdated":"2019-12-18T13:32:29-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493061_-1350303299","id":"20191217-094546_955511009","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100025"},{"text":"%sh\nhdfs dfs -cat dataset/stg_youtube/data/000000_0 | head","user":"yava","dateUpdated":"2019-12-18T13:32:33-0500","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493061_-1435549305","id":"20191217-094427_886359094","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100026"},{"text":"%md\n# LETS DO IN PYSPARK","user":"yava","dateUpdated":"2019-12-18T13:25:58-0500","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493062_-1685673306","id":"20191218-002451_1352395993","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-18T13:25:58-0500","dateFinished":"2019-12-18T13:25:58-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100027"},{"title":"Get SPARK version","text":"%spark.pyspark\nprint(\"Spark version : \" + spark.version)","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493062_-423899282","id":"20191217-100909_981800570","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100028"},{"text":"%spark.pyspark\n\nimport sys\nprint(\"Python version : \" + sys.version)","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493063_438108011","id":"20191218-144130_577483148","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100029"},{"title":"Test SPARK","text":"%spark.pyspark\n\nimport random\ndef inside(p):\n    x, y = random.random(), random.random()\n    return x*x + y*y < 1\n\nNUM_SAMPLES =100000\ncount = sc.parallelize(range(0, NUM_SAMPLES)) \\\n             .filter(inside).count()\n\nprint (\"Pi is roughly \" + str((4.0 * count / NUM_SAMPLES)))","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493063_1788032784","id":"20191217-100951_910119787","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100030"},{"title":"Read youtube dataset and converted into SPARK dataframe","text":"%spark.pyspark\nfrom pyspark.sql.types import *\n\nfile_path = \"hdfs://<ip-addr>/user/<user>/dataset/stg_youtube/data/000000_0\"\nyoutube_schema=StructType([\n    StructField(\"video_id\", StringType(), True),\n    StructField(\"trending_date\", IntegerType(), True),\n    StructField(\"title\", StringType(), True),\n    StructField(\"channel_title\", StringType(), True),\n    StructField(\"category_id\", IntegerType(), True),\n    StructField(\"publish_time\", StringType(), True),\n    StructField(\"tags\", StringType(), True),\n    StructField(\"views\", IntegerType(), True),\n    StructField(\"likes\", IntegerType(), True),\n    StructField(\"dislikes\", IntegerType(), True),\n    StructField(\"comment_count\", IntegerType(), True)\n])\n\n\ndf_youtube = spark.read \\\n .option(\"delimiter\", \"\\t\") \\\n .schema(youtube_schema) \\\n .option(\"inferSchema\", \"True\") \\\n .csv(file_path)\n","user":"yava","dateUpdated":"2019-12-20T07:05:52-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493064_-2056120989","id":"20191217-091557_772327780","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100031"},{"text":"%spark.pyspark\nfile_path = \"hdfs://<ip-adrr>/user/<user>/dataset/youtube_video_cat/category.dat\"\nyoutube_vd_cat_schema=StructType([\n    StructField(\"category_id\", IntegerType(), True),\n    StructField(\"category_name\", StringType(), True),\n])\n\n\nyoutube_video_cat = spark.read \\\n .option(\"delimiter\", \"|\") \\\n .schema(youtube_vd_cat_schema) \\\n .option(\"inferSchema\", \"True\") \\\n .csv(file_path)\n\nprint (\"Total Records: \" + str( youtube_video_cat.count()))","user":"yava","dateUpdated":"2019-12-20T07:06:08-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493064_831273464","id":"20191218-164558_1429034429","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100032"},{"text":"%spark.pyspark\ndf_youtube_full = df_youtube.join(youtube_video_cat, on=['category_id'], how='inner')\n\ndf_youtube_full.show(5)","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493064_-2116325476","id":"20191218-171354_301015569","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100033"},{"text":"%spark.pyspark\ndf_youtube.printSchema()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493065_763438961","id":"20191217-101836_309497658","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100034"},{"text":"%spark.pyspark\n\nprint (\"Total Records: \" + str( df_youtube.count()))\nprint(\"Number of Columns: \" + str(len(df_youtube.columns)))","user":"user13","dateUpdated":"2019-12-19T03:38:20-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493065_657235748","id":"20191217-102028_1174948602","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:38:20-0500","dateFinished":"2019-12-19T03:38:21-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100035"},{"text":"%spark.pyspark\nprint (\"Total Records: \" + str( df_youtube_full.count()))\nprint(\"Number of Columns: \" + str(len(df_youtube_full.columns)))\n\n","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493066_1522057414","id":"20191218-171539_1894385706","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100036"},{"title":"SELECT * FROM youtube LIMIT 10","text":"%spark.pyspark\ndf_youtube.show(5, truncate=True)","user":"user13","dateUpdated":"2019-12-19T03:40:24-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493066_-365812067","id":"20191217-101632_32250776","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:40:24-0500","dateFinished":"2019-12-19T03:40:24-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100037"},{"text":"%spark.pyspark\ndf_youtube.describe('category_id').show()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":4,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493067_1190876868","id":"20191218-144928_948497691","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100038"},{"text":"%spark.pyspark\ndf_youtube.describe('views').show()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":4,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493067_-357724634","id":"20191218-154455_1860537689","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100039"},{"text":"%spark.pyspark\ndf_youtube.describe('views').toPandas()","user":"user13","dateUpdated":"2019-12-19T03:42:34-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":4,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493067_1493897627","id":"20191218-154517_722472209","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:42:34-0500","dateFinished":"2019-12-19T03:42:34-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100040"},{"title":"SELECT trending_date, video_id, channel_title FROM youtube LIMIT 5","text":"%spark.pyspark\ndf_youtube.select(\"trending_date\", \"video_id\", \"channel_title\").show(5)","user":"user13","dateUpdated":"2019-12-19T03:41:28-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493068_1266029214","id":"20191217-120813_1047396207","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:41:28-0500","dateFinished":"2019-12-19T03:41:28-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100041"},{"title":"SELECT trending_date, count(1) num_video FROM youtube GROUP BY trending_date ORDER By trending_date DESC","text":"%spark.pyspark\nfrom pyspark.sql.functions import col\n\ndf = df_youtube \\\n        .groupBy(\"trending_date\") \\\n        .count() \\\n        .orderBy('trending_date', ascending=False) \\\n        .select(col(\"trending_date\"), col(\"count\").alias(\"num_video\"))\n\n\ndf.show()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493068_1689836984","id":"20191217-122407_389296822","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100042"},{"text":"%spark.pyspark\ndf.toPandas()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493069_1105741580","id":"20191218-145547_1081082346","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100043"},{"title":"What category have most views ?","text":"%md\n```\nSELECT \n category_id,\n sum(views) total_views,\n avg(views) avg_views\nFROM <user>.stg_youtube\nGROUP BY category_id\n```","user":"yava","dateUpdated":"2019-12-20T07:09:01-0500","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<pre><code>SELECT \n category_id,\n sum(views) total_views,\n avg(views) avg_views\nFROM &lt;user&gt;.stg_youtube\nGROUP BY category_id\n</code></pre>\n</div>"}]},"apps":[],"jobName":"paragraph_1576693493069_203460214","id":"20191218-003918_2134481834","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-20T07:09:01-0500","dateFinished":"2019-12-20T07:09:01-0500","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:100044"},{"title":"Most views category in dataframe","text":"%spark.pyspark\nfrom pyspark.sql import functions as F\n\nresult = df_youtube \\\n        .groupBy(\"category_id\") \\\n        .agg( \\\n            F.sum(col('views')).alias('total_views'), \\\n            F.avg(col('views')).alias('avg_views'), \\\n            F.count(F.lit(1)).alias('num_video') \\\n            ) \\\n        .orderBy('total_views', ascending=False) \n        \n        \nresult.toPandas()","user":"user13","dateUpdated":"2019-12-19T03:44:40-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493070_264568069","id":"20191218-005147_618107955","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:44:40-0500","dateFinished":"2019-12-19T03:44:42-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100045"},{"text":"%spark.pyspark\nresult = df_youtube_full \\\n        .groupBy(\"category_name\") \\\n        .agg( \\\n            F.sum(col('views')).alias('total_views'), \\\n            F.avg(col('views')).alias('avg_views'), \\\n            F.count(F.lit(1)).alias('num_video') \\\n            ) \\\n        .orderBy('total_views', ascending=False) \n        \n        \nresult.toPandas()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493070_1176416120","id":"20191218-171727_1288116740","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100046"},{"title":"Most views category in dataframe","text":"%spark.pyspark\nsqlContext.registerDataFrameAsTable(df_youtube_full, \"youtube\")\ndf2 = sqlContext.sql(\"SELECT category_name, \\\n                             sum(views) as total_views, \\\n                             avg(views) as avg_views, \\\n                             count(1) as num_video \\\n                      FROM youtube \\\n                      GROUP BY category_name \\\n                      ORDER BY total_views DESC\")\n\ndf2.show()","user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493071_-1947641304","id":"20191218-150747_1748664376","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100047"},{"title":"Data Visualization in Seaborn","text":"%spark.pyspark\n","user":"user13","dateUpdated":"2019-12-19T03:46:11-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493071_-87332152","id":"20191218-160254_2129172715","dateCreated":"2019-12-18T13:24:53-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100048"},{"title":"Most video category","text":"%spark.pyspark\nimport matplotlib.pyplot as plt\nimport seaborn as sns\nimport numpy as np\n\n\ndf2 = sqlContext.sql(\"SELECT category_name, count(1) as num_video \\\n                      FROM youtube \\\n                      GROUP BY category_name \\\n                      ORDER BY num_video DESC\" \\\n                    )\nresult_pd_df = df2.toPandas()\nsns.catplot(x='category_name', y='num_video', \\\n            data=result_pd_df, \\\n            order=result_pd_df['category_name'], \\\n            kind='bar')","user":"user13","dateUpdated":"2019-12-19T03:45:10-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493072_-1978030577","id":"20191218-160337_957762784","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:45:11-0500","dateFinished":"2019-12-19T03:45:20-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100049"},{"text":"%spark.pyspark\n\nresult_pd_df\n## plt.figure(figsize=(15,10))\nsns.set_style(\"whitegrid\")\nax = sns.barplot(y='category_name',x='num_video', \\\n                 data=result_pd_df, \\\n                 orient='h' \\\n                )\nplt.xlabel(\"Number of Videos\")\nplt.ylabel(\"Categories\")\nplt.title(\"Catogories of trend videos\")","user":"user5","dateUpdated":"2019-12-19T03:45:46-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493072_999366464","id":"20191218-172655_1529207592","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100050"},{"text":"%spark.pyspark\ndf2 = sqlContext.sql(\"SELECT video_id, count(1) as duration \\\n                      FROM youtube \\\n                      GROUP BY video_id \\\n                      ORDER BY duration DESC\" \\\n                    )\nresult_pd_df = df2.toPandas()\nresult_pd_df.head(20)","user":"user13","dateUpdated":"2019-12-19T03:46:27-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493073_1923091907","id":"20191218-173606_1916026713","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:46:27-0500","dateFinished":"2019-12-19T03:46:30-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100051"},{"text":"%spark.pyspark\ndf2 = sqlContext.sql(\"SELECT category_name, sum(likes) as total_likes, \\\n                             sum(dislikes) as total_dislikes, \\\n                             (sum(likes)/sum(dislikes)) as ratio \\\n                      FROM youtube \\\n                      GROUP BY category_name \\\n                      ORDER BY ratio DESC\" \\\n                    )\n                    \nresult_pd_df = df2.toPandas()\nresult_pd_df.head(20)","user":"user13","dateUpdated":"2019-12-19T03:48:11-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493073_1929139232","id":"20191218-160342_1492605339","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:48:11-0500","dateFinished":"2019-12-19T03:48:13-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100052"},{"text":"%spark.pyspark\n\n##plt.figure(figsize=(15,10))\nsns.set_style(\"whitegrid\")\nax = sns.barplot(y='category_name',x='ratio', \\\n                 data=result_pd_df, \\\n                 orient='h' \\\n                )\nplt.xlabel(\"Ratio\")\nplt.ylabel(\"Categories\")\nplt.title(\"Ratio like vs dislike video\")","user":"user13","dateUpdated":"2019-12-19T03:48:22-0500","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true,"completionKey":"TAB"},"colWidth":6,"editorMode":"ace/mode/python","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493074_1973668961","id":"20191218-175320_417070279","dateCreated":"2019-12-18T13:24:53-0500","dateStarted":"2019-12-19T03:48:22-0500","dateFinished":"2019-12-19T03:48:25-0500","status":"FINISHED","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100053"},{"user":"yava","dateUpdated":"2019-12-18T13:24:53-0500","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1576693493076_414744371","id":"20191217-114445_458371721","dateCreated":"2019-12-18T13:24:53-0500","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100054"}],"name":"Big Data Analytics Quick Start/LABS 07: Answering Business Question","id":"2EWA3FVC3","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"hive:yava:":[],"sh:yava:":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}